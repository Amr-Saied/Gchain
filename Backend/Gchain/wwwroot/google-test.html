<!DOCTYPE html>
<html>
  <head>
    <title>Google OAuth Test</title>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 40px;
      }
      .container {
        max-width: 800px;
      }
      textarea {
        width: 100%;
        height: 150px;
        font-family: monospace;
        font-size: 12px;
      }
      button {
        padding: 10px 20px;
        background: #4285f4;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        margin: 5px;
      }
      button:hover {
        background: #3367d6;
      }
      .success {
        color: green;
        font-weight: bold;
      }
      .token-container {
        background: #f5f5f5;
        padding: 20px;
        border-radius: 8px;
        margin: 20px 0;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>üîë Google OAuth Test for Your API</h1>
      <p><strong>Your API:</strong> <code>http://localhost:5024</code></p>
      <p>Click below to get an ID token for testing:</p>

      <div
        id="g_id_onload"
        data-client_id="851230874085-n1qa7390r4eov4jkgdtr32oedmv28nr7.apps.googleusercontent.com"
        data-callback="handleCredentialResponse"
      ></div>
      <div
        class="g_id_signin"
        data-type="standard"
        data-theme="outline"
        data-size="large"
      ></div>

      <div id="result" style="display: none">
        <div class="token-container">
          <h3 class="success">‚úÖ ID Token Generated!</h3>
          <p>Copy this token for Swagger testing:</p>
          <textarea id="token-text" readonly></textarea>
          <div>
            <button onclick="copyToken()">üìã Copy Token</button>
            <button onclick="openSwagger()">üß™ Open Swagger</button>
            <button onclick="showInstructions()">üìù Show Instructions</button>
          </div>
        </div>
      </div>

      <div id="instructions" style="display: none" class="token-container">
        <h3>üìã Testing Instructions:</h3>
        <ol>
          <li>
            <strong>Make sure your API is running:</strong>
            <pre
              style="
                background: #333;
                color: #fff;
                padding: 10px;
                border-radius: 4px;
              "
            >
cd Backend/Gchain
dotnet run --launch-profile http</pre
            >
          </li>
          <li>
            <strong>Open Swagger:</strong>
            <a href="http://localhost:5024/swagger" target="_blank"
              >http://localhost:5024/swagger</a
            >
          </li>
          <li>
            <strong>Find endpoint:</strong>
            <code>POST /api/auth/google/login</code>
          </li>
          <li><strong>Click "Try it out"</strong></li>
          <li>
            <strong>Use this request body:</strong>
            <pre
              id="request-body"
              style="background: #f0f0f0; padding: 15px; border-radius: 4px"
            >
{
  "token": "your-copied-token-here",
  "tokenType": "id_token"
}</pre
            >
          </li>
          <li><strong>Click "Execute"</strong></li>
        </ol>
      </div>

      <div
        style="
          margin-top: 30px;
          padding: 15px;
          background: #e8f4fd;
          border-radius: 5px;
        "
      >
        <h4>üí° Why This Method Works Better:</h4>
        <ul>
          <li>‚úÖ No authorization code expiration issues</li>
          <li>‚úÖ Direct ID token generation</li>
          <li>‚úÖ Works with your existing Google Console setup</li>
          <li>‚úÖ Perfect for API testing</li>
        </ul>
      </div>
    </div>

    <script>
      function handleCredentialResponse(response) {
        console.log("‚úÖ ID Token received");
        document.getElementById("token-text").value = response.credential;
        document.getElementById("result").style.display = "block";

        // Update request body preview
        const requestBody = document.getElementById("request-body");
        if (requestBody) {
          requestBody.textContent = `{
  "token": "${response.credential}",
  "tokenType": "id_token"
}`;
        }
      }

      function copyToken() {
        const tokenText = document.getElementById("token-text");
        tokenText.select();
        document.execCommand("copy");
        alert("‚úÖ Token copied! Now paste it in Swagger.");
      }

      function openSwagger() {
        window.open("http://localhost:5024/swagger", "_blank");
      }

      function showInstructions() {
        const instructions = document.getElementById("instructions");
        instructions.style.display =
          instructions.style.display === "none" ? "block" : "none";
      }
    </script>
  </body>
</html>
